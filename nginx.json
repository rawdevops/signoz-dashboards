{"description":"Nginx Metrics Dashboard for nginx-module-vts ","layout":[{"h":3,"i":"3acd6ed4-8f86-465c-9322-e084554ce765","moved":false,"static":false,"w":6,"x":6,"y":12},{"h":3,"i":"dd95a91b-4672-4337-a102-c1187b3eb492","moved":false,"static":false,"w":6,"x":0,"y":12},{"h":3,"i":"e3e3a4eb-98f0-4265-8131-48f64c8d0c5d","moved":false,"static":false,"w":4,"x":8,"y":9},{"h":3,"i":"8e5b8763-5f90-4910-a742-5e2c972d5d93","moved":false,"static":false,"w":4,"x":4,"y":9},{"h":3,"i":"788533d8-1199-431d-abd8-bea0a2c5fa0c","moved":false,"static":false,"w":4,"x":0,"y":9},{"h":3,"i":"e0a9b1a0-0ed2-405e-abce-a8ec992aaf04","moved":false,"static":false,"w":6,"x":6,"y":6},{"h":3,"i":"15599e08-6567-4eec-bf7e-dff87ec25277","moved":false,"static":false,"w":6,"x":0,"y":6},{"h":3,"i":"82671d21-4031-4006-9b3d-2a528c7802c4","moved":false,"static":false,"w":6,"x":6,"y":3},{"h":3,"i":"07e1cdcc-d8f0-43cd-b39b-c886702de82b","moved":false,"static":false,"w":6,"x":0,"y":3},{"h":3,"i":"91518614-4c18-47c1-95ad-a024f0668c06","moved":false,"static":false,"w":4,"x":4,"y":0},{"h":3,"i":"1b1f9b1d-eb08-4d01-bfdb-91b62bc4b2e8","moved":false,"static":false,"w":4,"x":8,"y":0},{"h":3,"i":"465c9b32-f1b8-40b8-ae25-e7cbc397eb85","moved":false,"static":false,"w":4,"x":0,"y":0}],"tags":[],"title":"Nginx Dashboard","uploadedGrafana":false,"variables":{"dfb9f019-3a60-4269-9204-aeb48b67ec2e":{"allSelected":false,"customValue":"","description":"Select nginx service tag","id":"dfb9f019-3a60-4269-9204-aeb48b67ec2e","modificationUUID":"27be5c23-e2ab-4220-9949-373de1d67223","multiSelect":false,"name":"nginx_service_name","order":0,"queryValue":"SELECT DISTINCT JSONExtractString(labels, 'nginx_service_name') AS extracted_label\nFROM signoz_metrics.distributed_time_series_v2\nWHERE JSONExtractString(labels, '__name__') = 'nginx_vts_info'","selectedValue":"my-nginx","showALLOption":false,"sort":"DISABLED","textboxValue":"","type":"QUERY"}},"widgets":[{"description":"","fillSpans":false,"id":"465c9b32-f1b8-40b8-ae25-e7cbc397eb85","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"key":"","type":""},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"0cd38387-2eea-4fb5-b98d-febfacce4332","promql":[{"disabled":false,"legend":"rps","name":"A","query":"sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":null,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Nginx Requests/s","yAxisUnit":"reqps"},{"description":"","fillSpans":false,"id":"1b1f9b1d-eb08-4d01-bfdb-91b62bc4b2e8","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"key":"","type":""},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"de17f22c-9c74-426e-be9e-7898c1df770f","promql":[{"disabled":false,"legend":"rpm","name":"A","query":"sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m])) * 60"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":null,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Nginx RPM","yAxisUnit":"short"},{"description":"","fillSpans":false,"id":"91518614-4c18-47c1-95ad-a024f0668c06","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"key":"","type":""},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"b35edfdf-969a-4733-8aea-106dcb0ddbe8","promql":[{"disabled":false,"legend":"{{code}}","name":"A","query":"sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\", code!=\"8xx\"}[2m])) by (code)"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":null,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Nginx Requests/s (by status code)","yAxisUnit":"reqps"},{"description":"","fillSpans":false,"id":"07e1cdcc-d8f0-43cd-b39b-c886702de82b","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"key":"","type":""},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"0ac2e6c3-612d-4b54-ae7b-2cc09b67e7a9","promql":[{"disabled":false,"legend":"2xx","name":"A","query":"100* sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\", code=\"2xx\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"3xx","name":"B","query":"100* sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\", code=\"3xx\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"4xx","name":"C","query":"100* sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\", code=\"4xx\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"5xx","name":"D","query":"100* sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\", code=\"5xx\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"1xx","name":"E","query":"100* sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\", code=\"1xx\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":1,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"% Requests by Code /s","yAxisUnit":"percent"},{"description":"","fillSpans":false,"id":"82671d21-4031-4006-9b3d-2a528c7802c4","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"key":"","type":""},"aggregateOperator":"avg","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"920c3d71-8663-432d-993b-0558cec6a179","promql":[{"disabled":false,"legend":"4xx","name":"C","query":"100* sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\", code=\"4xx\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"5xx","name":"D","query":"100* sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\", code=\"5xx\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":null,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"% 4xx 5xx Requests/s","yAxisUnit":"percent"},{"description":"","fillSpans":false,"id":"15599e08-6567-4eec-bf7e-dff87ec25277","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"isJSON":false,"key":"","type":""},"aggregateOperator":"count","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"6977428e-c1a2-4164-8bd6-cf37100d0873","promql":[{"disabled":false,"legend":"{{status}}","name":"A","query":"sum(rate(nginx_vts_server_cache_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m])) by (status)"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":null,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Nginx Cache Status","yAxisUnit":"reqps"},{"description":"","fillSpans":false,"id":"e0a9b1a0-0ed2-405e-abce-a8ec992aaf04","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"isJSON":false,"key":"","type":""},"aggregateOperator":"count","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"ee9c1383-0567-474c-8c81-1ffe4dbcb5e1","promql":[{"disabled":false,"legend":"hit","name":"A","query":"100*sum(rate(nginx_vts_server_cache_total{nginx_service_name=\"{{.nginx_service_name}}\",status=\"hit\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"miss","name":"B","query":"100*sum(rate(nginx_vts_server_cache_total{nginx_service_name=\"{{.nginx_service_name}}\",status=\"miss\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"bypass","name":"C","query":"100*sum(rate(nginx_vts_server_cache_total{nginx_service_name=\"{{.nginx_service_name}}\",status=\"bypass\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"expired","name":"D","query":"100*sum(rate(nginx_vts_server_cache_total{nginx_service_name=\"{{.nginx_service_name}}\",status=\"expired\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"stale","name":"E","query":"100*sum(rate(nginx_vts_server_cache_total{nginx_service_name=\"{{.nginx_service_name}}\",status=\"stale\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"updating","name":"F","query":"100*sum(rate(nginx_vts_server_cache_total{nginx_service_name=\"{{.nginx_service_name}}\",status=\"updating\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"revalidated","name":"G","query":"100*sum(rate(nginx_vts_server_cache_total{nginx_service_name=\"{{.nginx_service_name}}\",status=\"revalidated\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"},{"disabled":false,"legend":"scarce","name":"H","query":"100*sum(rate(nginx_vts_server_cache_total{nginx_service_name=\"{{.nginx_service_name}}\",status=\"scarce\"}[2m])) / sum(rate(nginx_vts_server_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m]))"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":null,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Nginx Cache Rate","yAxisUnit":"percent"},{"description":"","fillSpans":false,"id":"788533d8-1199-431d-abd8-bea0a2c5fa0c","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"key":"","type":""},"aggregateOperator":"count","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"e62da200-02cf-478c-9d9e-15ae9c1239f7","promql":[{"disabled":false,"legend":"{{status}}","name":"A","query":"sum(rate(nginx_vts_main_connections{nginx_service_name=\"{{.nginx_service_name}}\"}[2m])) by (status)"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":null,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Nginx Connections","yAxisUnit":"short"},{"description":"","fillSpans":false,"id":"8e5b8763-5f90-4910-a742-5e2c972d5d93","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"key":"","type":""},"aggregateOperator":"count","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"f89bdaa9-1ceb-413c-8d08-f0d6bfd30aab","promql":[{"disabled":false,"legend":"{{code}}","name":"A","query":"sum(rate(nginx_vts_upstream_requests_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m])) by (code)"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":null,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Nginx Upstream Status","yAxisUnit":"reqps"},{"description":"","fillSpans":false,"id":"e3e3a4eb-98f0-4265-8131-48f64c8d0c5d","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"key":"","type":""},"aggregateOperator":"count","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"558cc288-c267-4695-b441-494eb7c98d02","promql":[{"disabled":false,"legend":"{{cache_size}}","name":"A","query":"nginx_vts_cache_usage_bytes{nginx_service_name=\"{{.nginx_service_name}}\"}"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":null,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Cache Usage Size","yAxisUnit":"decbytes"},{"description":"","fillSpans":false,"id":"dd95a91b-4672-4337-a102-c1187b3eb492","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"isJSON":false,"key":"","type":""},"aggregateOperator":"count","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"89f754cd-fa7d-410d-869d-883963b64b2a","promql":[{"disabled":false,"legend":"{{direction}}","name":"A","query":"sum(rate(nginx_vts_server_bytes_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m])) by (direction)"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":null,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Nginx Bytes In/Out","yAxisUnit":"Bps"},{"description":"","fillSpans":false,"id":"3acd6ed4-8f86-465c-9322-e084554ce765","isStacked":false,"nullZeroValues":"zero","opacity":"1","panelTypes":"graph","query":{"builder":{"queryData":[{"aggregateAttribute":{"dataType":"","id":"------false","isColumn":false,"isJSON":false,"key":"","type":""},"aggregateOperator":"count","dataSource":"metrics","disabled":false,"expression":"A","filters":{"items":[],"op":"AND"},"groupBy":[],"having":[],"legend":"","limit":null,"orderBy":[],"queryName":"A","reduceTo":"sum","stepInterval":60}],"queryFormulas":[]},"clickhouse_sql":[{"disabled":false,"legend":"","name":"A","query":""}],"id":"bf064c63-9d01-4559-9386-8f130b994898","promql":[{"disabled":false,"legend":"{{direction}}","name":"A","query":"sum(rate(nginx_vts_cache_bytes_total{nginx_service_name=\"{{.nginx_service_name}}\"}[2m])) by (direction)"}],"queryType":"promql"},"selectedLogFields":null,"selectedTracesFields":null,"softMax":null,"softMin":null,"thresholds":[],"timePreferance":"GLOBAL_TIME","title":"Cache Nginx Bytes In/Out","yAxisUnit":"Bps"}]}